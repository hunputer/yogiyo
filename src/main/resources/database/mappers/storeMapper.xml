<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="com.jh.yogiyo.store.StoreMapper">
	<select id="getList" parameterType="StoreVO" resultMap="getOneResult">
		select S.*, SM.*
		from store S left join storemanage SM
		on S.num = SM.storeNum
		<choose>
			<when test="categoryNum != 0">
				where S.categoryNum = #{categoryNum}
			</when>
		</choose>
	</select>
	
	<resultMap type="StoreVO" id="getOneResult">
			<id column="num" property="num"/>
			<result column="categoryNum" property="categoryNum"/>
			<result column="storeName" property="storeName"/>
			<result column="storeNum" property="storeNum"/>
			<result column="tel" property="tel" />
			<result column="address" property="address" />
			<result column="zipCode" property="zipCode" />
			<result column="id" property="id" />
			<collection property="storeManage" javaType="java.util.List" ofType="StoreManageVO">
				<result column="openTime" property="openTime"/>
				<result column="closeTime" property="closeTime"/>
				<result column="holiday" property="holiday"/>
				<result column="minPrice" property="minPrice" />
				<result column="driveFee" property="driveFee" />
				<result column="takeTime" property="takeTime" />
				<result column="takeTime" property="takeTime" />
				<result column="isOpen" property="isOpen" />
				<result column="storeComment" property="storeComment" />
			</collection>
	</resultMap>
</mapper>